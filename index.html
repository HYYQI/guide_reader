<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>导游词阅读器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding-bottom: 80px;
        }
        
        /* 顶部导航栏 */
        header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 15px 20px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo i {
            font-size: 1.5rem;
        }
        
        .logo h1 {
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .current-file {
            font-size: 0.9rem;
            opacity: 0.9;
            max-width: 60%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        /* 文件选择区域 */
        .file-selector {
            background-color: white;
            padding: 15px 20px;
            border-bottom: 1px solid #eaeaea;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .file-selector label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: #444;
            font-size: 1rem;
        }
        
        .file-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            background-color: #f9f9f9;
            color: #333;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%236a11cb' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px;
        }
        
        /* 内容显示区域 */
        .content-container {
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .sentence {
            margin-bottom: 20px;
            padding: 18px 20px;
            border-radius: 12px;
            font-size: 1.1rem;
            line-height: 1.7;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.2s, box-shadow 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        .sentence:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.12);
        }
        
        .sentence-number {
            position: absolute;
            top: 10px;
            right: 15px;
            background-color: rgba(255, 255, 255, 0.7);
            color: #333;
            font-size: 0.8rem;
            font-weight: 600;
            padding: 3px 8px;
            border-radius: 10px;
        }
        
        /* 控制按钮 */
        .controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.08);
            z-index: 50;
        }
        
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            flex: 1;
            margin: 0 5px;
        }
        
        .btn-secondary {
            background-color: #f0f0f0;
            color: #555;
            flex: 1;
            margin: 0 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        /* 加载状态 */
        .loading {
            text-align: center;
            padding: 40px 20px;
            color: #666;
            font-size: 1.1rem;
        }
        
        .loading i {
            font-size: 2rem;
            margin-bottom: 15px;
            color: #6a11cb;
        }
        
        /* 空状态 */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #888;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #ccc;
        }
        
        /* 响应式调整 */
        @media (max-width: 480px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .current-file {
                max-width: 100%;
                font-size: 0.85rem;
            }
            
            .sentence {
                padding: 15px;
                font-size: 1.05rem;
            }
            
            .btn {
                padding: 10px 15px;
                font-size: 0.95rem;
            }
        }
    </style>
</head>
<body>
    <!-- 顶部导航栏 -->
    <header>
        <div class="header-content">
            <div class="logo">
                <i class="fas fa-map-marked-alt"></i>
                <h1>导游词阅读器</h1>
            </div>
            <div class="current-file" id="currentFile">未选择文件</div>
        </div>
    </header>
    
    <!-- 文件选择区域 -->
    <div class="file-selector">
        <label for="fileSelect"><i class="fas fa-file-alt"></i> 选择导游词文件</label>
        <select id="fileSelect" class="file-select">
            <option value="">请选择文件...</option>
            <!-- 文件选项将通过JavaScript动态添加 -->
        </select>
    </div>
    
    <!-- 内容显示区域 -->
    <div class="content-container" id="contentContainer">
        <div class="loading" id="loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>加载中...</p>
        </div>
    </div>
    
    <!-- 控制按钮 -->
    <div class="controls">
        <button class="btn btn-secondary" id="prevBtn">
            <i class="fas fa-chevron-left"></i> 上一句
        </button>
        <button class="btn btn-primary" id="nextBtn">
            下一句 <i class="fas fa-chevron-right"></i>
        </button>
    </div>

    <script>
        // 模拟的文本文件数据（实际应用中应从服务器获取）
        const textFiles = {
            "beijing.txt": `北京故宫，旧称紫禁城，位于北京中轴线的中心，是明清两个朝代的皇宫。故宫是世界上现存规模最大、保存最为完整的木质结构古建筑之一。故宫始建于明成祖永乐四年（1406年），永乐十八年（1420年）建成。故宫南北长961米，东西宽753米，四面围有高10米的城墙，城外有宽52米的护城河。故宫有大小宫殿七十多座，房屋九千余间。故宫的建筑分为外朝和内廷两部分。外朝的中心为太和殿、中和殿、保和殿，统称三大殿，是国家举行大典礼的地方。内廷的中心是乾清宫、交泰殿、坤宁宫，统称后三宫，是皇帝和皇后居住的正宫。`,
            
            "greatwall.txt": `长城，又称万里长城，是中国古代的军事防御工事，是一道高大、坚固而且连绵不断的长垣，用以限隔敌骑的行动。长城不是一道单纯孤立的城墙，而是以城墙为主体，同大量的城、障、亭、标相结合的防御体系。长城修筑的历史可上溯到西周时期，发生在首都镐京的著名典故"烽火戏诸侯"就源于此。春秋战国时期列国争霸，互相防守，长城修筑进入第一个高潮，但此时修筑的长度都比较短。秦灭六国统一天下后，秦始皇连接和修缮战国长城，始有万里长城之称。明朝是最后一个大修长城的朝代，今天人们所看到的长城多是此时修筑。长城资源主要分布在河北、北京、天津、山西、陕西、甘肃、内蒙古、黑龙江、吉林、辽宁、山东、河南、青海、宁夏、新疆等15个省区市。`,
            
            "terracotta.txt": `秦始皇陵兵马俑，亦简称秦兵马俑或秦俑，是第一批全国重点文物保护单位、第一批中国世界遗产，位于今陕西省西安市临潼区秦始皇陵以东1.5千米处的兵马俑坑内。兵马俑是古代墓葬雕塑的一个类别。古代实行人殉，奴隶是奴隶主生前的附属品，奴隶主死后奴隶要作为殉葬品为奴隶主陪葬。兵马俑即制成兵马（战车、战马、士兵）形状的殉葬品。1961年3月4日，秦始皇陵被国务院公布为第一批全国重点文物保护单位。1974年3月，兵马俑被发现。1987年，秦始皇陵及兵马俑坑被联合国教科文组织批准列入《世界遗产名录》，并被誉为"世界第八大奇迹"，先后有200多位外国元首和政府首脑参观访问，成为中国古代辉煌文明的一张金字名片，被誉为世界十大古墓稀世珍宝之一。`
        };
        
        // 鲜艳的颜色数组
        const brightColors = [
            "#FF6B6B", "#4ECDC4", "#FFD166", "#06D6A0", "#118AB2",
            "#EF476F", "#FF9A76", "#7BC950", "#9D4EDD", "#FFAFCC",
            "#A2D2FF", "#FF8E53", "#2A9D8F", "#E9C46A", "#F4A261",
            "#E76F51", "#2A9D8F", "#E63946", "#A8DADC", "#1D3557",
            "#FF595E", "#6A0572", "#FF9E00", "#3D5A80", "#EE6C4D"
        ];
        
        // DOM元素
        const fileSelect = document.getElementById('fileSelect');
        const contentContainer = document.getElementById('contentContainer');
        const currentFileElement = document.getElementById('currentFile');
        const loadingElement = document.getElementById('loading');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        
        // 当前状态
        let currentSentences = [];
        let currentIndex = 0;
        let currentFileName = "";
        
        // 初始化文件选择下拉框
        function initFileSelect() {
            // 清空现有选项（除了第一个提示选项）
            while (fileSelect.options.length > 1) {
                fileSelect.remove(1);
            }
            
            // 添加文件选项
            Object.keys(textFiles).forEach(fileName => {
                const option = document.createElement('option');
                option.value = fileName;
                option.textContent = fileName.replace('.txt', '');
                fileSelect.appendChild(option);
            });
        }
        
        // 加载选中的文件
        async function loadFile(fileName) {
            if (!fileName) return;
            
            // 显示加载状态
            loadingElement.style.display = 'block';
            contentContainer.innerHTML = '';
            contentContainer.appendChild(loadingElement);
            
            // 模拟从服务器加载文件（实际应用中应使用fetch API）
            setTimeout(() => {
                const content = textFiles[fileName];
                if (content) {
                    // 分割文本为句子
                    currentSentences = splitIntoSentences(content);
                    currentFileName = fileName;
                    currentIndex = 0;
                    
                    // 更新当前文件显示
                    currentFileElement.textContent = fileName.replace('.txt', '');
                    
                    // 渲染第一句
                    renderCurrentSentence();
                }
                
                // 隐藏加载状态
                loadingElement.style.display = 'none';
            }, 500);
        }
        
        // 将文本分割为句子
        function splitIntoSentences(text) {
            // 简单的句子分割逻辑，实际应用可能需要更复杂的处理
            return text.split(/[。！？!?]/)
                .filter(sentence => sentence.trim().length > 0)
                .map(sentence => sentence.trim() + (sentence.endsWith('。') ? '' : '。'));
        }
        
        // 渲染当前句子
        function renderCurrentSentence() {
            contentContainer.innerHTML = '';
            
            if (currentSentences.length === 0) {
                // 显示空状态
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                emptyState.innerHTML = `
                    <i class="fas fa-file-alt"></i>
                    <p>文件内容为空或无法加载</p>
                `;
                contentContainer.appendChild(emptyState);
                return;
            }
            
            // 创建句子元素
            const sentenceElement = document.createElement('div');
            sentenceElement.className = 'sentence';
            
            // 随机选择颜色（但确保相邻句子颜色不同）
            let colorIndex = currentIndex % brightColors.length;
            sentenceElement.style.backgroundColor = brightColors[colorIndex];
            sentenceElement.style.color = getContrastColor(brightColors[colorIndex]);
            
            // 添加句子编号
            const numberElement = document.createElement('div');
            numberElement.className = 'sentence-number';
            numberElement.textContent = `${currentIndex + 1}/${currentSentences.length}`;
            sentenceElement.appendChild(numberElement);
            
            // 添加句子内容
            const textElement = document.createElement('p');
            textElement.textContent = currentSentences[currentIndex];
            sentenceElement.appendChild(textElement);
            
            contentContainer.appendChild(sentenceElement);
            
            // 更新按钮状态
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === currentSentences.length - 1;
        }
        
        // 获取对比色（确保文本可读）
        function getContrastColor(hexColor) {
            // 将十六进制颜色转换为RGB
            const r = parseInt(hexColor.substr(1, 2), 16);
            const g = parseInt(hexColor.substr(3, 2), 16);
            const b = parseInt(hexColor.substr(5, 2), 16);
            
            // 计算亮度
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            
            // 根据亮度返回黑色或白色
            return brightness > 128 ? '#000000' : '#FFFFFF';
        }
        
        // 显示上一句
        function showPreviousSentence() {
            if (currentIndex > 0) {
                currentIndex--;
                renderCurrentSentence();
                
                // 滚动到顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
        
        // 显示下一句
        function showNextSentence() {
            if (currentIndex < currentSentences.length - 1) {
                currentIndex++;
                renderCurrentSentence();
                
                // 滚动到顶部
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }
        
        // 事件监听
        fileSelect.addEventListener('change', function() {
            loadFile(this.value);
        });
        
        prevBtn.addEventListener('click', showPreviousSentence);
        nextBtn.addEventListener('click', showNextSentence);
        
        // 添加键盘支持
        document.addEventListener('keydown', function(event) {
            if (event.key === 'ArrowLeft') {
                showPreviousSentence();
            } else if (event.key === 'ArrowRight') {
                showNextSentence();
            }
        });
        
        // 添加触控滑动支持
        // 添加触控滑动支持
        let touchStartX = 0;
        let touchEndX = 0;
        
        contentContainer.addEventListener('touchstart', function(event) {
            touchStartX = event.changedTouches[0].screenX;
        }, false);
        
        contentContainer.addEventListener('touchend', function(event) {
            touchEndX = event.changedTouches[0].screenX;
            handleSwipe();
        }, false);
        
        function handleSwipe() {
            const swipeThreshold = 50; // 最小滑动距离
            
            if (touchEndX < touchStartX - swipeThreshold) {
                // 向左滑动 - 下一句
                showNextSentence();
            } else if (touchEndX > touchStartX + swipeThreshold) {
                // 向右滑动 - 上一句
                showPreviousSentence();
            }
        }
        
        // 初始化应用
        function initApp() {
            initFileSelect();
            
            // 默认加载第一个文件
            const firstFileName = Object.keys(textFiles)[0];
            if (firstFileName) {
                fileSelect.value = firstFileName;
                loadFile(firstFileName);
            }
            
            // 隐藏加载状态
            loadingElement.style.display = 'none';
        }
        
        // 页面加载完成后初始化应用
        document.addEventListener('DOMContentLoaded', initApp);
        
        // 添加朗读功能
        const speakBtn = document.createElement('button');
        speakBtn.className = 'btn btn-primary';
        speakBtn.id = 'speakBtn';
        speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> 朗读';
        
        // 将朗读按钮添加到控制区域
        const controls = document.querySelector('.controls');
        controls.insertBefore(speakBtn, nextBtn);
        
        // 朗读功能
        speakBtn.addEventListener('click', function() {
            if (!currentSentences.length || currentIndex >= currentSentences.length) return;
            
            const utterance = new SpeechSynthesisUtterance(currentSentences[currentIndex]);
            utterance.lang = 'zh-CN';
            utterance.rate = 0.9;
            
            // 切换按钮状态
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
                speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> 朗读';
            } else {
                speechSynthesis.speak(utterance);
                speakBtn.innerHTML = '<i class="fas fa-stop"></i> 停止';
                
                utterance.onend = function() {
                    speakBtn.innerHTML = '<i class="fas fa-volume-up"></i> 朗读';
                };
            }
        });
        
        // 添加自动播放模式
        const autoPlayBtn = document.createElement('button');
        autoPlayBtn.className = 'btn btn-secondary';
        autoPlayBtn.id = 'autoPlayBtn';
        autoPlayBtn.innerHTML = '<i class="fas fa-play"></i> 自动播放';
        
        // 将自动播放按钮添加到控制区域
        controls.insertBefore(autoPlayBtn, prevBtn);
        
        let autoPlayInterval = null;
        
        autoPlayBtn.addEventListener('click', function() {
            if (autoPlayInterval) {
                // 停止自动播放
                clearInterval(autoPlayInterval);
                autoPlayInterval = null;
                autoPlayBtn.innerHTML = '<i class="fas fa-play"></i> 自动播放';
                autoPlayBtn.classList.remove('btn-primary');
                autoPlayBtn.classList.add('btn-secondary');
            } else {
                // 开始自动播放
                autoPlayBtn.innerHTML = '<i class="fas fa-pause"></i> 停止播放';
                autoPlayBtn.classList.remove('btn-secondary');
                autoPlayBtn.classList.add('btn-primary');
                
                autoPlayInterval = setInterval(function() {
                    if (currentIndex < currentSentences.length - 1) {
                        showNextSentence();
                    } else {
                        // 播放到末尾，停止自动播放
                        clearInterval(autoPlayInterval);
                        autoPlayInterval = null;
                        autoPlayBtn.innerHTML = '<i class="fas fa-play"></i> 自动播放';
                        autoPlayBtn.classList.remove('btn-primary');
                        autoPlayBtn.classList.add('btn-secondary');
                    }
                }, 3000); // 3秒切换一句
            }
        });
        
        // 添加字体大小调整功能
        const fontSizeControl = document.createElement('div');
        fontSizeControl.className = 'font-size-control';
        fontSizeControl.innerHTML = `
            <button class="font-btn" id="fontSmaller">A-</button>
            <span class="font-size-label">字体大小</span>
            <button class="font-btn" id="fontBigger">A+</button>
        `;
        
        // 将字体控制添加到文件选择区域下方
        const fileSelector = document.querySelector('.file-selector');
        fileSelector.parentNode.insertBefore(fontSizeControl, fileSelector.nextSibling);
        
        // 添加字体控制样式
        const fontSizeStyle = document.createElement('style');
        fontSizeStyle.textContent = `
            .font-size-control {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 15px;
                padding: 12px 20px;
                background-color: white;
                border-bottom: 1px solid #eaeaea;
            }
            
            .font-btn {
                width: 40px;
                height: 40px;
                border-radius: 50%;
                border: 2px solid #6a11cb;
                background-color: white;
                color: #6a11cb;
                font-size: 1.2rem;
                font-weight: bold;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: all 0.2s;
            }
            
            .font-btn:hover {
                background-color: #6a11cb;
                color: white;
            }
            
            .font-size-label {
                font-weight: 600;
                color: #555;
                font-size: 0.95rem;
            }
        `;
        document.head.appendChild(fontSizeStyle);
        
        // 字体大小控制功能
        let currentFontSize = 1.1; // rem
        
        document.getElementById('fontSmaller').addEventListener('click', function() {
            if (currentFontSize > 0.8) {
                currentFontSize -= 0.1;
                updateFontSize();
            }
        });
        
        document.getElementById('fontBigger').addEventListener('click', function() {
            if (currentFontSize < 1.8) {
                currentFontSize += 0.1;
                updateFontSize();
            }
        });
        
        function updateFontSize() {
            const sentences = document.querySelectorAll('.sentence');
            sentences.forEach(sentence => {
                sentence.style.fontSize = `${currentFontSize}rem`;
            });
        }
        
        // 添加夜间模式切换
        const nightModeToggle = document.createElement('div');
        nightModeToggle.className = 'night-mode-toggle';
        nightModeToggle.innerHTML = `
            <label class="switch">
                <input type="checkbox" id="nightModeCheckbox">
                <span class="slider"></span>
            </label>
            <span class="night-mode-label">夜间模式</span>
        `;
        
        // 将夜间模式切换添加到字体控制下方
        fontSizeControl.parentNode.insertBefore(nightModeToggle, fontSizeControl.nextSibling);
        
        // 添加夜间模式样式
        const nightModeStyle = document.createElement('style');
        nightModeStyle.textContent = `
            .night-mode-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 15px;
                padding: 12px 20px;
                background-color: white;
                border-bottom: 1px solid #eaeaea;
            }
            
            .switch {
                position: relative;
                display: inline-block;
                width: 50px;
                height: 26px;
            }
            
            .switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }
            
            .slider {
                position: absolute;
                cursor: pointer;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #ccc;
                transition: .4s;
                border-radius: 34px;
            }
            
            .slider:before {
                position: absolute;
                content: "";
                height: 18px;
                width: 18px;
                left: 4px;
                bottom: 4px;
                background-color: white;
                transition: .4s;
                border-radius: 50%;
            }
            
            input:checked + .slider {
                background-color: #6a11cb;
            }
            
            input:checked + .slider:before {
                transform: translateX(24px);
            }
            
            .night-mode-label {
                font-weight: 600;
                color: #555;
                font-size: 0.95rem;
            }
            
            body.night-mode {
                background-color: #121212;
                color: #e0e0e0;
            }
            
            body.night-mode .file-selector,
            body.night-mode .font-size-control,
            body.night-mode .night-mode-toggle,
            body.night-mode .controls {
                background-color: #1e1e1e;
                border-color: #333;
            }
            
            body.night-mode .file-select {
                background-color: #2d2d2d;
                border-color: #444;
                color: #e0e0e0;
            }
            
            body.night-mode .btn-secondary {
                background-color: #2d2d2d;
                color: #e0e0e0;
            }
            
            body.night-mode .empty-state {
                color: #aaa;
            }
            
            body.night-mode .empty-state i {
                color: #555;
            }
        `;
        document.head.appendChild(nightModeStyle);
        
        // 夜间模式切换功能
        document.getElementById('nightModeCheckbox').addEventListener('change', function() {
            document.body.classList.toggle('night-mode', this.checked);
            
            // 保存夜间模式设置到本地存储
            localStorage.setItem('nightMode', this.checked);
        });
        
        // 加载夜间模式设置
        const savedNightMode = localStorage.getItem('nightMode') === 'true';
        document.getElementById('nightModeCheckbox').checked = savedNightMode;
        if (savedNightMode) {
            document.body.classList.add('night-mode');
        }
        
        // 添加进度指示器
        const progressIndicator = document.createElement('div');
        progressIndicator.className = 'progress-indicator';
        
        // 将进度指示器添加到导航栏
        const headerContent = document.querySelector('.header-content');
        headerContent.appendChild(progressIndicator);
        
        // 添加进度指示器样式
        const progressStyle = document.createElement('style');
        progressStyle.textContent = `
            .progress-indicator {
                width: 100%;
                height: 4px;
                background-color: rgba(255, 255, 255, 0.2);
                border-radius: 2px;
                margin-top: 10px;
                overflow: hidden;
                display: none;
            }
            
            .progress-bar {
                height: 100%;
                background-color: #FFD166;
                border-radius: 2px;
                transition: width 0.3s ease;
            }
            
            .current-file {
                display: flex;
                flex-direction: column;
                align-items: flex-end;
            }
            
            .progress-text {
                font-size: 0.75rem;
                opacity: 0.8;
                margin-top: 2px;
            }
        `;
        document.head.appendChild(progressStyle);
        
        // 更新进度指示器
        function updateProgressIndicator() {
            if (currentSentences.length === 0) {
                progressIndicator.style.display = 'none';
                return;
            }
            
            const progress = ((currentIndex + 1) / currentSentences.length) * 100;
            
            // 创建或更新进度条
            let progressBar = progressIndicator.querySelector('.progress-bar');
            if (!progressBar) {
                progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                progressIndicator.innerHTML = '';
                progressIndicator.appendChild(progressBar);
            }
            
            progressBar.style.width = `${progress}%`;
            progressIndicator.style.display = 'block';
            
            // 更新进度文本
            let progressText = currentFileElement.querySelector('.progress-text');
            if (!progressText) {
                progressText = document.createElement('div');
                progressText.className = 'progress-text';
                currentFileElement.appendChild(progressText);
            }
            
            progressText.textContent = `${currentIndex + 1}/${currentSentences.length}`;
        }
        
        // 在渲染句子时更新进度指示器
        const originalRenderCurrentSentence = renderCurrentSentence;
        renderCurrentSentence = function() {
            originalRenderCurrentSentence();
            updateProgressIndicator();
        };
        
        // 在加载文件时也更新进度指示器
        const originalLoadFile = loadFile;
        loadFile = async function(fileName) {
            await originalLoadFile(fileName);
            updateProgressIndicator();
        };
        
        // 初始化完成
        console.log('导游词阅读器初始化完成');
    </script>
</body>
</html>